<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Relat√≥rio de Visita - Soloforte</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="header-bar">
        <div class="header-close" onclick="clearLocalStorage()">üóëÔ∏è</div>
        <div class="header-title">Relat√≥rio de Visita</div>
        <div class="header-save">
            <div class="header-action" onclick="exportToPDF()">PDF</div>
            <div class="header-action" onclick="window.print()">üñ®Ô∏è</div>
        </div>
    </div>

    <div class="container">
        <div class="content">
            <!-- Informa√ß√µes da Visita -->
            <div class="section">
                <div class="section-title">Informa√ß√µes da Visita</div>
                <div class="form-row">
                    <label>Produtor</label>
                    <input type="text" id="produtor" placeholder="Nome">
                </div>
                <div class="form-row">
                    <label>Propriedade</label>
                    <input type="text" id="propriedade" placeholder="Nome">
                </div>
                <div class="form-row">
                    <label>Data</label>
                    <input type="date" id="data">
                </div>
                <div class="form-row">
                    <label>√Årea (ha)</label>
                    <input type="number" id="area" placeholder="0.00" step="0.01">
                </div>
                <div class="form-row">
                    <label>Cultivar</label>
                    <input type="text" id="cultivar" placeholder="TMG 7062">
                </div>
                <div class="form-row">
                    <label>Plantio</label>
                    <input type="date" id="plantio" onchange="calculateDAP()">
                </div>
                <div class="dap-info" id="dapInfo">
                    <strong>DAP: <span id="dapValue">0</span> dias</strong>
                </div>
            </div>

            <!-- Est√°dio Fenol√≥gico -->
            <div class="section">
                <div class="section-title">Est√°dio Fenol√≥gico</div>
                <div class="form-row">
                    <label>Est√°dio</label>
                    <select id="stageSelect" onchange="showStageInfo()">
                        <option value="">Selecione</option>
                        <option value="VE">VE - Emerg√™ncia</option>
                        <option value="VC">VC - Cotil√©dones</option>
                        <option value="V1">V1 - 1¬™ Trifoliolada</option>
                        <option value="V2">V2 - 2¬™ Trifoliolada</option>
                        <option value="V3">V3 - 3¬™ Trifoliolada</option>
                        <option value="V4">V4 - 4¬™ Trifoliolada</option>
                        <option value="V5">V5 - 5¬™ Trifoliolada</option>
                        <option value="R1">R1 - Florescimento</option>
                        <option value="R2">R2 - Flora√ß√£o Plena</option>
                        <option value="R3">R3 - Vagens 1cm</option>
                        <option value="R4">R4 - Vagens 2cm</option>
                        <option value="R5.1">R5.1 - In√≠cio Enchimento</option>
                        <option value="R5.3">R5.3 - 50% Enchimento</option>
                        <option value="R5.5">R5.5 - 100% Enchimento</option>
                        <option value="R6">R6 - Gr√£os Formados</option>
                        <option value="R7">R7 - In√≠cio Matura√ß√£o</option>
                        <option value="R8">R8 - Matura√ß√£o Plena</option>
                    </select>
                </div>

                <div class="stage-display" id="stageDisplay">
                    <div class="stage-icon-large" id="stageIcon"></div>
                    <div class="stage-name-large" id="stageName"></div>
                    <div class="stage-description-large" id="stageDescription"></div>
                    <div class="dap-badge" id="stageDap"></div>
                </div>

                <div class="attention-points" id="attentionPoints">
                    <h3>‚ö†Ô∏è Pontos de Aten√ß√£o</h3>
                    <ul id="attentionList"></ul>
                </div>
            </div>

            <!-- Categorias -->
            <div class="section">
                <div class="section-title">Categoria</div>
                <div class="category-grid">
                    <div class="category-item" onclick="toggleCategory('doenca')" data-category="doenca">
                        <div class="category-circle doenca">
                            <img src="imagens/doencas.png" alt="Doen√ßa">
                        </div>
                        <div class="category-name">Doen√ßa</div>
                    </div>
                    <div class="category-item" onclick="toggleCategory('insetos')" data-category="insetos">
                        <div class="category-circle insetos">
                            <img src="imagens/insetos.png" alt="Insetos">
                        </div>
                        <div class="category-name">Insetos</div>
                    </div>
                    <div class="category-item" onclick="toggleCategory('ervas')" data-category="ervas">
                        <div class="category-circle ervas">
                            <img src="imagens/ervas.png" alt="Ervas daninhas">
                        </div>
                        <div class="category-name">Ervas daninhas</div>
                    </div>
                    <div class="category-item" onclick="toggleCategory('nutrientes')" data-category="nutrientes">
                        <div class="category-circle nutrientes">
                            <img src="imagens/nutricional.png" alt="Nutrientes">
                        </div>
                        <div class="category-name">Nutrientes</div>
                    </div>
                    <div class="category-item" onclick="toggleCategory('agua')" data-category="agua">
                        <div class="category-circle agua">
                            <img src="imagens/estresse.png" alt="√Ågua">
                        </div>
                        <div class="category-name">√Ågua</div>
                    </div>
                </div>
            </div>

            <!-- Problems Container -->
            <div id="problemsContainer"></div>

            <!-- Full Photos Section -->
            <div class="section-photos-full" id="fullPhotosSection">
                <div class="section-title">Todas as Fotos</div>
                <div class="photos-list-full" id="photosListFull"></div>
                
                <div class="pdf-settings-section" id="pdfSettings">
                    <div class="pdf-settings-title">üìÑ Configura√ß√µes do PDF</div>
                    <div class="pdf-setting-row">
                        <div class="pdf-setting-label">Qualidade</div>
                        <div style="display: flex; gap: 6px;">
                            <button class="photo-size-btn" onclick="setPhotoQuality('baixa', this)">Baixa</button>
                            <button class="photo-size-btn active" onclick="setPhotoQuality('media', this)">M√©dia</button>
                            <button class="photo-size-btn" onclick="setPhotoQuality('alta', this)">Alta</button>
                        </div>
                    </div>
                    <div class="pdf-setting-row">
                        <div class="pdf-setting-label">Fotos/P√°gina</div>
                        <div style="display: flex; gap: 6px;">
                            <button class="photo-size-btn active" onclick="setPhotosPerPage(1, this)">1</button>
                            <button class="photo-size-btn" onclick="setPhotosPerPage(2, this)">2</button>
                            <button class="photo-size-btn" onclick="setPhotosPerPage(3, this)">3</button>
                        </div>
                    </div>
                    <div class="pdf-setting-row" style="border: none;">
                        <div class="pdf-setting-label">Tamanho</div>
                        <div class="pdf-setting-value" id="estimatedSize">~2.5 MB</div>
                    </div>
                </div>
            </div>

            <!-- Observa√ß√µes -->
            <div class="section">
                <div class="section-title">Observa√ß√µes</div>
                <div class="form-row">
                    <textarea id="observacoes" placeholder="Observa√ß√µes gerais sobre a lavoura..."></textarea>
                </div>
            </div>

            <!-- Recomenda√ß√µes -->
            <div class="section">
                <div class="section-title">Recomenda√ß√µes</div>
                <div class="form-row">
                    <textarea id="recomendacoes" placeholder="Recomenda√ß√µes t√©cnicas..."></textarea>
                </div>
            </div>

            <!-- Respons√°vel -->
            <div class="section">
                <div class="section-title">Respons√°vel</div>
                <div class="form-row">
                    <input type="text" id="tecnico" placeholder="Nome do t√©cnico">
                </div>
            </div>

            <!-- Localiza√ß√£o -->
            <div class="section">
                <div class="section-title">Localiza√ß√£o</div>
                <div class="form-row">
                    <label>Coordenadas</label>
                    <input type="text" id="coordenadas" placeholder="Pin" readonly>
                </div>
                <div style="padding: 12px 0; color: #007AFF; cursor: pointer; font-size: 0.95em;" onclick="getCurrentLocation()">
                    üìç Definir localiza√ß√£o atual
                </div>
            </div>

            <!-- Tipo de Ocorr√™ncia -->
            <div class="section">
                <div class="section-title">Tipo de Ocorr√™ncia</div>
                <div style="display: flex; gap: 30px; padding: 12px 0;">
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; flex: none;">
                        <input type="radio" name="tipo" value="sazonal" checked style="width: 20px; height: 20px;">
                        <span>Sazonal</span>
                    </label>
                    <label style="display: flex; align-items: center; gap: 10px; cursor: pointer; flex: none;">
                        <input type="radio" name="tipo" value="permanente" style="width: 20px; height: 20px;">
                        <span>Permanente</span>
                    </label>
                </div>
            </div>

            <!-- Amostras -->
            <div class="section">
                <div class="section-title">Amostras</div>
                <div style="padding: 12px 0;">
                    <label style="display: flex; align-items: center; gap: 12px; cursor: pointer;">
                        <input type="checkbox" id="amostraSolo" style="width: 22px; height: 22px;">
                        <span>Amostra de solo</span>
                    </label>
                </div>
            </div>
        </div>
    </div>

    <!-- Floating Photo Button -->
    <div class="floating-photo-btn" id="floatingPhotoBtn" onclick="takePhotoForActiveCategory()">
        <span class="floating-photo-btn-icon">üì∑</span>
        <span class="floating-photo-btn-text">Pr√≥xima foto:</span>
        <span class="floating-photo-btn-category" id="floatingCategoryName">
            <img src="imagens/doencas.png" alt="" id="floatingCategoryIcon">
            <span id="floatingCategoryText">Doen√ßa</span>
        </span>
    </div>

    <input type="file" id="photoInput" accept="image/*" capture="environment" onchange="handlePhoto()" style="display: none;">

    <div class="save-indicator" id="saveIndicator">‚úì Salvo</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="script.js"></script>
</body>
</html>
